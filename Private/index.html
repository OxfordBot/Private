
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <style>
            * {
                border: 0;
                padding: 0;
                margin: 0;
                font-family: consolas
            }
            .container {
                width: calc(1080px / 3.75);
                height: calc(1920px / 3.75);
                background-color: #222222;
                margin: 10px;
                border: 1px solid #000000;
                border-radius: 5px;
            }
            .message-line {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .right {
                display: flex;
                justify-content: right;
                align-items: right;
            }
            .message-item {
                display: inline-block;
                padding: 5px;
                padding-left: 7.5px;
                padding-right: 7.5px;
                margin-right: 5px;
                background-color: #EEEEEE;
                border-radius: 5px;
                color: #000000;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="message-line right">
                <div class="message-item">Deez</div>
            </div>
        </div>
    </body>
    <script>
        if (navigator.onLine) {
            socket = new WebSocket("ws://localhost:3000")
            socket.addEventListener("open", () => {
                if (!localStorage.getItem("cache")) {
                    socket.send(JSON.stringify({
                        type: "request-continue",
                        headers: {
                            username: "Zavier"
                        }
                    }))
                } else {
                    socket.send(JSON.stringify({
                        type: "request-token",
                        headers: {
                            uuid: JSON.parse(localStorage.getItem("cache")).uuid
                        }
                    }))
                }
                socket.addEventListener("message", ({ data }) => {
                    packet = JSON.parse(data)
                    if (packet.type.includes("response-continue")) {
                        localStorage.setItem("cache", JSON.stringify({
                            username: packet.content.username,
                            uuid: packet.content.uuid
                        }))
                    } else if (packet.type.includes("response-token")) {
                        localStorage.setItem("token", packet.content.uuid)
                        socket.send(JSON.stringify({
                            type: "request-send",
                            headers: {
                                recepient_uuid: JSON.parse(localStorage.getItem("cache")).uuid,
                                sender_uuid: JSON.parse(localStorage.getItem("cache")).uuid,
                                content: "Deez"
                            }
                        }))
                    } else if (packet.type.includes("request-receive")) {
                        console.log(packet)
                    }
                })
            })
        }
    </script>
</html>
